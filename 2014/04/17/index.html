<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="A blog about all things programming by val antonini.">
    <title>Communication between iFrames with IE8 support</title>
    <link rel="canonical" href="http://arakawa.asia/2014/04/17">
    <!-- Custom CSS -->

    <link rel="icon" href="http://arakawa.asia/images/favicon.png">

    <!--<script src="http://arakawa.asia/bower_components/jquery/dist/jquery.min.js"></script>-->
<script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script>if (!window.jQuery) {
    var localjQuery = 'http://arakawa.asia/bower_components/jquery/dist/jquery.min.js';
    var localjQueryScript = '<script src="'+localjQuery+'"><\/script>';
    document.write(localjQueryScript);
}
</script>
    <!-- website by valantonini -->
     <!--Background pattern from subtlepatterns.com -->
</head>


<body>
<div class="arakawa-bg">
    <div class="container">
        <nav class="navbar navbar-default navbar-static-top/Users/val/Downloads/paper_fibers/paper_fibers.png">
    <div class="container">

        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar"
                    aria-expanded="false" aria-controls="navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="http://arakawa.asia">
                <img src="http://arakawa.asia/images/logo.png" alt="arakawa icon" class="logo">
                arakawa.asia
            </a>
        </div>

        <div id="navbar" class="navbar-collapse collapse">
            <ul class="nav navbar-nav">
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
                        Posts<span class="caret"></span>
                    </a>
                    <ul class="dropdown-menu" role="menu">
                        <li><a href="http://arakawa.asia/posts/" title="all posts">All Posts</a></li>
                        <li><a href="http://arakawa.asia/categories/" title="categories">Categories</a></li>
                        <li><a href="http://arakawa.asia/tags/" title="tags">Tags</a></li>
                        <li><a href="http://arakawa.asia/search/" title="search">Search</a></li>
                    </ul>
                </li>
                <li>
                    <a href="http://arakawa.asia/about" title="About Me">About</a>
                </li>
                <li>
                    <a href="http://arakawa.asia/contact" title="Contact Me">Contact</a>
                </li>
            </ul>
        </div>

    </div>
</nav>

        <div class="content">
            <div class="row">
                <div class="col-md-12">
                    <div class="post">

    <header>
        <h1>Communication between iFrames with IE8 support</h1>

        <p class="meta">
            Apr 17, 2014 â€¢ val antonini
        </p>
    </header>

    <article>
        <p>
This is a way to talk between iframes (even on different domains) with support for Internet Explorer 8 and 9 (which only support sending strings as the message data). It works by stringifying a JSON object and using that as the event data. It requires a jQuery 1.x to guarantee compatibility with IE8.
</p>

<p>
An example of it can be found <a href="http://arakawa.asia/samples/iFrameCommunication/OuterIframe" title="iframe communication sample" target="_blank">here</a>.
</p>

<p>
Place this in the outer iframe to listen for messages:
</p>

<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nx">$</span><span class="p">(</span><span class="nb">window</span><span class="p">).</span><span class="nx">bind</span><span class="p">(</span><span class="s1">&#39;message&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">originalEvent</span><span class="p">.</span><span class="nx">data</span><span class="p">);</span>
        <span class="nx">alert</span><span class="p">(</span><span class="s2">&quot;outer iframe received: &quot;</span> <span class="o">+</span> <span class="nx">x</span><span class="p">.</span><span class="nx">MyProperty</span><span class="p">);</span>
    <span class="p">});</span>
<span class="p">});</span></code></pre></div>

<p>
And post to the outer iframe from the inner iframe like this:
</p>

<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">//replace with your desired JSON object</span>
<span class="kd">var</span> <span class="nx">sampleJsonObject</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">MyProperty</span><span class="o">:</span> <span class="s2">&quot;Inner Iframe Value&quot;</span>
<span class="p">};</span>

<span class="nx">parent</span><span class="p">.</span><span class="nx">postMessage</span><span class="p">(</span>
    <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">sampleJsonObject</span><span class="p">),</span>
    <span class="s2">&quot;http://arakawa.asia&quot;</span>
<span class="p">);</span></code></pre></div>

<p>
For posting to the inner iframe add the message binding code above to the inner iframe and post to the inner iframe (with an id of "innerIframe") from the outer iframe using the below:
</p>

<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">//replace with your desired JSON object</span>
<span class="kd">var</span> <span class="nx">sampleJsonObject</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">MyProperty</span><span class="o">:</span> <span class="s2">&quot;Outer Iframe Value&quot;</span>
<span class="p">};</span>

<span class="kd">var</span> <span class="nx">iFrameContentWindow</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#innerIframe&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="nx">contentWindow</span><span class="p">;</span>
<span class="nx">iFrameContentWindow</span><span class="p">.</span><span class="nx">postMessage</span><span class="p">(</span>
    <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">sampleJsonObject</span><span class="p">),</span>
    <span class="s2">&quot;http://arakawa.asia&quot;</span>
<span class="p">);</span></code></pre></div>

<p>
If you are doing this from razor you can use the below for the source url:
</p>

<div class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="n">@String</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="s">&quot;{0}://{1}&quot;</span><span class="p">,</span> <span class="n">Request</span><span class="p">.</span><span class="n">Url</span><span class="p">.</span><span class="n">Scheme</span><span class="p">,</span> <span class="n">Request</span><span class="p">.</span><span class="n">Url</span><span class="p">.</span><span class="n">Host</span><span class="p">)</span><span class="c1">//eg. resolves to http://localhost or http://url.com</span></code></pre></div>

<p>
e.g:
</p>

<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">parent</span><span class="p">.</span><span class="nx">postMessage</span><span class="p">(</span>
    <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">sampleJsonObject</span><span class="p">),</span>
    <span class="s2">&quot;@String.Format(&quot;</span><span class="p">{</span><span class="mi">0</span><span class="p">}</span><span class="o">:</span><span class="c1">//{1}&quot;, Request.Url.Scheme, Request.Url.Host)&quot;</span>
<span class="p">);</span></code></pre></div>
    </article>

    <div class="tags">
        <span>Tags:</span>
        


        <span class="tag">
            <a href="http://arakawa.asia/tag/web%20development

">
    Web Development
</a>
        </span>
        


        <span class="tag">
            <a href="http://arakawa.asia/tag/javascript

">
    Javascript
</a>
        </span>
        


        <span class="tag">
            <a href="http://arakawa.asia/tag/jquery

">
    jQuery
</a>
        </span>
        


        <span class="tag">
            <a href="http://arakawa.asia/tag/iframes

">
    iframes
</a>
        </span>
        
    </div>

    
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'arakawa'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    

</div>
                </div>
            </div>
        </div>
    </div>
    <footer>
        <a href="http://arakawa.asia/feed.xml" title="rss" target="_blank"><img src="http://arakawa.asia/images/rss.png" alt="rss icon" class="icon"></a>
<a href="https://www.github.com/valantonini" title="github" target="_blank"><img src="http://arakawa.asia/images/github.png" alt="github icon" class="icon"></a>
<a href="http://arakawa.asia" title="home"><img src="http://arakawa.asia/images/logo.png" alt="arakawa icon" class="icon"></a>


    </footer>
</div>
<!--<link rel="stylesheet" href="http://arakawa.asia/css/main.css">-->
<link rel="stylesheet" href="http://arakawa.asia/css/site.css">
<script src="http://arakawa.asia/bower_components/bootstrap-sass-official/assets/javascripts/bootstrap.js"></script>
<script src="http://arakawa.asia/bower_components/simple-jekyll-search/dest/jekyll-search.js"></script>
<script src="http://arakawa.asia/js/site.js"></script>

<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-42499658-1', 'auto');
    ga('send', 'pageview');
</script>

</body>
</html>