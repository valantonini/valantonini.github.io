<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="A blog about all things programming by val antonini.">
    <title>Communication between iFrames with IE8 support</title>
    <link rel="canonical" href="https://valantonini.com/2014/04/17">


    <link rel="icon" href="https://valantonini.com/images/favicon.png">

    <link href="https://fonts.googleapis.com/css?family=Merriweather%3A400%2C300%2C300italic%2C400italic%2C700%2C700italic&#038;ver=4.1"
        rel="stylesheet">

    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>


    <link rel="stylesheet" href="https://valantonini.com/public/main.css">
    <link rel="stylesheet" href="https://valantonini.com/public/vendor.css">

    <script src="https://valantonini.com/public/vendor.js"></script>
    <script src="https://valantonini.com/public/main.js"></script>
    <!-- website by valantonini -->
    <!--Background pattern from subtlepatterns.com -->
</head>


<body>
    <div class="arakawa-bg">
        <div class="container">
            <nav class="navbar navbar-light navbar-expand-md">
    <a class="navbar-brand" href="https://valantonini.com">
        <img src="https://valantonini.com/images/logo.png" alt="arakawa icon" class="logo">
        valantonini.com
    </a>

    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavDropdown" aria-controls="navbarNavDropdown"
        aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarNavDropdown">
        <ul class="navbar-nav ml-auto">

            <li class="nav-item dropdown">
                <a class="nav-link dropdown-toggle" href="#" id="blogMenuLink" data-toggle="dropdown" aria-haspopup="true"
                    aria-expanded="false">
                    Blog
                </a>
                <div class="dropdown-menu" aria-labelledby="blogMenuLink">
                    <a class="dropdown-item" href="https://valantonini.com/posts/" title="all posts">All Posts</a>
                    <a class="dropdown-item" href="https://valantonini.com/categories/" title="categories">Categories</a>
                    <a class="dropdown-item" href="https://valantonini.com/tags/" title="tags">Tags</a>
                    <a class="dropdown-item" href="https://valantonini.com/search/" title="search">Search</a>
                </div>
            </li>

            <li class="nav-item">
                <a class="nav-link" href="https://valantonini.com/about" title="about me">About</a>
            </li>

            <li class="nav-item">
                <a class="nav-link" href="https://valantonini.com/resume" title="resume">Resume</a>
            </li>

            <li class="nav-item">
                <a class="nav-link" href="https://valantonini.com/services" title="services">Services</a>
            </li>

            <li class="nav-item">
                <a class="nav-link" href="https://valantonini.com/contact" title="contact me">Contact</a>
            </li>

        </ul>
    </div>

</nav>
            <div class="content">
                <div class="row">
                    <div class="col-md-12">
                        <div class="post">

    <header>
        <h1>Communication between iFrames with IE8 support</h1>

        <p class="meta">
            Apr 17, 2014 â€¢ val antonini
        </p>
    </header>

    <article>
        <p>
This is a way to talk between iframes (even on different domains) with support for Internet Explorer 8 and 9 (which only support sending strings as the message data). It works by stringifying a JSON object and using that as the event data. It requires a jQuery 1.x to guarantee compatibility with IE8.
</p>

<p>
An example of it can be found <a href="https://valantonini.com/samples/iFrameCommunication/OuterIframe" title="iframe communication sample" target="_blank">here</a>.
</p>

<p>
Place this in the outer iframe to listen for messages:
</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nx">$</span><span class="p">(</span><span class="nb">window</span><span class="p">).</span><span class="nx">bind</span><span class="p">(</span><span class="s1">'message'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">originalEvent</span><span class="p">.</span><span class="nx">data</span><span class="p">);</span>
        <span class="nx">alert</span><span class="p">(</span><span class="s2">"outer iframe received: "</span> <span class="o">+</span> <span class="nx">x</span><span class="p">.</span><span class="nx">MyProperty</span><span class="p">);</span>
    <span class="p">});</span>
<span class="p">});</span></code></pre></figure>

<p>
And post to the outer iframe from the inner iframe like this:
</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">//replace with your desired JSON object</span>
<span class="kd">var</span> <span class="nx">sampleJsonObject</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">MyProperty</span><span class="p">:</span> <span class="s2">"Inner Iframe Value"</span>
<span class="p">};</span>

<span class="nx">parent</span><span class="p">.</span><span class="nx">postMessage</span><span class="p">(</span>
    <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">sampleJsonObject</span><span class="p">),</span>
    <span class="s2">"https://valantonini.com"</span>
<span class="p">);</span></code></pre></figure>

<p>
For posting to the inner iframe add the message binding code above to the inner iframe and post to the inner iframe (with an id of "innerIframe") from the outer iframe using the below:
</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">//replace with your desired JSON object</span>
<span class="kd">var</span> <span class="nx">sampleJsonObject</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">MyProperty</span><span class="p">:</span> <span class="s2">"Outer Iframe Value"</span>
<span class="p">};</span>

<span class="kd">var</span> <span class="nx">iFrameContentWindow</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s2">"#innerIframe"</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="nx">contentWindow</span><span class="p">;</span>
<span class="nx">iFrameContentWindow</span><span class="p">.</span><span class="nx">postMessage</span><span class="p">(</span>
    <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">sampleJsonObject</span><span class="p">),</span>
    <span class="s2">"https://valantonini.com"</span>
<span class="p">);</span></code></pre></figure>

<p>
If you are doing this from razor you can use the below for the source url:
</p>

<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="n">@String</span><span class="p">.</span><span class="nf">Format</span><span class="p">(</span><span class="s">"{0}://{1}"</span><span class="p">,</span> <span class="n">Request</span><span class="p">.</span><span class="n">Url</span><span class="p">.</span><span class="n">Scheme</span><span class="p">,</span> <span class="n">Request</span><span class="p">.</span><span class="n">Url</span><span class="p">.</span><span class="n">Host</span><span class="p">)</span><span class="c1">//eg. resolves to http://localhost or http://url.com</span></code></pre></figure>

<p>
e.g:
</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">parent</span><span class="p">.</span><span class="nx">postMessage</span><span class="p">(</span>
    <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">sampleJsonObject</span><span class="p">),</span>
    <span class="s2">"@String.Format("</span><span class="p">{</span><span class="mi">0</span><span class="p">}:</span><span class="c1">//{1}", Request.Url.Scheme, Request.Url.Host)"</span>
<span class="p">);</span></code></pre></figure>
    </article>

    <div class="tags">
        <span>Tags:</span>
        


        <span class="tag">
            <a href="https://valantonini.com/tag/web%20development

">
    Web Development
</a>
        </span>
        


        <span class="tag">
            <a href="https://valantonini.com/tag/javascript

">
    Javascript
</a>
        </span>
        


        <span class="tag">
            <a href="https://valantonini.com/tag/jquery

">
    jQuery
</a>
        </span>
        


        <span class="tag">
            <a href="https://valantonini.com/tag/iframes

">
    iframes
</a>
        </span>
        
    </div>

    
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'arakawa'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    

</div>
                    </div>
                </div>
            </div>
        </div>
        <footer>
            <div class="no-print">
                <a href="https://valantonini.com/feed.xml" title="rss" target="_blank">
                    <img src="https://valantonini.com/images/rss.png" alt="rss icon" class="icon">
                </a>
                <a href="https://valantonini.com" title="home">
                    <img src="https://valantonini.com/images/logo.png" alt="arakawa icon" class="icon">
                </a>
                <a href="https://www.github.com/valantonini" title="github" target="_blank">
                    <img src="https://valantonini.com/images/github.png" alt="github icon" class="icon">
                </a>
            </div>
        </footer>
    </div>
    <!--<link rel="stylesheet" href="https://valantonini.com/css/main.css">-->



    
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-42499658-1', 'auto');
    ga('send', 'pageview');
</script>
    
</body>

</html>